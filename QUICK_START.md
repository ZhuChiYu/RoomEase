# 快速开始指南

## 🎉 本地存储版本已就绪

您的RoomEase应用现已配置为使用本地存储，所有数据保存在设备本地，完全离线可用！

## 📦 安装依赖

```bash
cd apps/mobile
pnpm install
```

## 🚀 启动应用

```bash
# 启动开发服务器
pnpm start

# 在iOS模拟器运行
pnpm ios

# 在Android模拟器运行  
pnpm android
```

## ✨ 新功能

### 1. 本地数据存储
- ✅ 所有数据自动保存到设备本地
- ✅ 应用重启后数据自动恢复
- ✅ 完全离线工作，无需网络

### 2. 数据管理（个人中心）
- ✅ **数据统计**：查看房间、预订、房态数量
- ✅ **数据导出**：支持JSON和CSV格式
- ✅ **数据导入**：从备份文件恢复数据
- ✅ **数据备份**：一键备份所有数据
- ✅ **清除数据**：清空所有本地数据

## 📱 使用流程

### 首次使用

1. **启动应用**
   ```bash
   pnpm start
   ```
   应用会自动初始化本地数据存储

2. **开始使用**
   - 添加房间
   - 创建预订
   - 管理房态
   - 所有操作自动保存到本地

3. **定期备份**（推荐）
   ```
   个人中心 → 数据管理 → 数据备份
   ```
   将备份文件保存到云盘或其他安全位置

### 日常使用

**创建预订**
```
日历 → 选择房间和日期 → 填写客人信息 → 确认
```

**查看预订**
```
预订 → 查看列表 → 点击查看详情
```

**管理房态**
```
日历 → 长按房间格子 → 选择操作（设置脏房、关房等）
```

**数据备份**
```
个人中心 → 数据管理 → 数据备份
```

### 数据迁移

**导出数据（迁移前）**
```
个人中心 → 数据管理 → 数据导出 → 完整备份（JSON）
```

**导入数据（迁移后）**
```
个人中心 → 数据管理 → 数据导入 → 选择备份文件
```

## 🔄 未来切换到服务器

当您准备使用服务器存储时，只需：

1. **导出当前数据**
   ```
   个人中心 → 数据导出 → 完整备份
   ```

2. **修改配置文件**
   ```typescript
   // apps/mobile/app/config/dataSource.ts
   export const dataSourceConfig = {
     type: 'remote',  // 改为 'remote'
     apiUrl: 'https://your-server.com',
   }
   ```

3. **重启应用**
   ```bash
   pnpm start
   ```

4. **导入数据到服务器**
   使用备份文件将数据导入到服务器

## 📊 数据格式

### JSON备份文件

导出的JSON文件包含：
```json
{
  "version": "1.0.0",
  "exportDate": "2024-01-15T10:30:00.000Z",
  "data": {
    "rooms": [...],          // 所有房间
    "reservations": [...],   // 所有预订
    "roomStatuses": [...]    // 所有房态记录
  },
  "metadata": {
    "totalRooms": 7,
    "totalReservations": 15,
    "totalRoomStatuses": 45
  }
}
```

### CSV文件

**房间数据CSV**：可以在Excel中打开编辑
```csv
房间ID,房间号,房型
1202,1202,大床房
```

**预订数据CSV**：可以导入到其他系统
```csv
订单号,房间号,客人姓名,手机号,入住日期,退房日期,...
```

## ⚙️ 配置说明

### 数据源配置

文件：`apps/mobile/app/config/dataSource.ts`

```typescript
// 本地存储模式（当前）
type: 'local'

// 服务器模式（未来）
type: 'remote'
apiUrl: 'https://your-server.com'
```

### 功能开关

```typescript
// 启用本地缓存
enableCache: true

// 启用离线模式（服务器模式下也可离线工作）
enableOfflineMode: true
```

## 🔍 文件位置

### 核心文件

```
apps/mobile/app/
├── config/
│   └── dataSource.ts              # 数据源配置（本地/远程）
├── services/
│   ├── localDataService.ts        # 本地数据服务
│   ├── dataBackupService.ts       # 备份导入导出
│   └── storage.ts                 # 存储服务
├── (tabs)/
│   ├── calendar.tsx               # 日历页面
│   ├── reservations.tsx           # 预订列表
│   └── profile.tsx                # 个人中心（含数据管理）
└── _layout.tsx                    # 应用初始化
```

### 文档

```
├── DATA_MANAGEMENT_GUIDE.md       # 数据管理详细指南
├── LOCAL_STORAGE_IMPLEMENTATION.md # 技术实现文档
├── QUICK_START.md                 # 本文档
└── README.md                      # 项目主文档
```

## 💡 小贴士

### 数据安全

- ✅ 定期导出备份（建议每周一次）
- ✅ 将备份保存到多个位置（云盘+本地）
- ✅ 重要操作前先备份
- ✅ 更新应用前先导出数据

### 性能优化

- ✅ 定期清理过期预订
- ✅ 大量历史数据可以导出后删除
- ✅ 保持数据量在合理范围内

### 最佳实践

- ✅ 每天开始工作前查看数据统计
- ✅ 每周导出一次备份
- ✅ 月底导出CSV用于财务统计
- ✅ 季度末备份完整数据

## ⚠️ 注意事项

1. **数据仅在本设备**
   - 本地模式数据不同步到其他设备
   - 需要手动导出/导入来迁移数据

2. **存储空间限制**
   - AsyncStorage约6MB限制
   - 数据量大时考虑迁移到服务器

3. **数据备份重要性**
   - 卸载应用会清除所有数据
   - 设备损坏/丢失会导致数据丢失
   - 必须定期备份！

4. **导入数据会覆盖**
   - 导入操作会替换所有现有数据
   - 导入前务必先导出当前数据

## 🆘 常见问题

**Q: 数据保存在哪里？**  
A: 使用React Native的AsyncStorage，保存在应用的本地存储中。

**Q: 卸载应用后数据会丢失吗？**  
A: 是的。卸载前请务必导出备份。

**Q: 可以在多个设备同步吗？**  
A: 本地模式不支持。需要导出/导入，或切换到服务器模式。

**Q: 导出的文件在哪里？**  
A: 导出后会显示系统分享菜单，可以保存到文件、云盘或发送。

**Q: 如何恢复误删的数据？**  
A: 如果有备份文件，通过"数据导入"恢复。没有备份则无法恢复。

**Q: CSV文件乱码怎么办？**  
A: 用记事本打开CSV，另存为ANSI编码，再用Excel打开。

## 📞 获取帮助

- 📖 详细文档：[DATA_MANAGEMENT_GUIDE.md](./DATA_MANAGEMENT_GUIDE.md)
- 🔧 技术文档：[LOCAL_STORAGE_IMPLEMENTATION.md](./LOCAL_STORAGE_IMPLEMENTATION.md)
- 📧 技术支持：support@roomease.com

## 🎯 下一步

1. ✅ 启动应用测试功能
2. ✅ 添加一些测试数据
3. ✅ 尝试导出/导入功能
4. ✅ 设置定期备份提醒
5. ✅ 阅读完整的数据管理指南

---

**版本**：v1.0.0  
**状态**：✅ 生产就绪  
**更新**：2024-01-15

祝使用愉快！🎉

